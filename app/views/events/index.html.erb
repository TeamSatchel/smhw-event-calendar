<h1>Events calendar</h1>

<div id='add-event'>
  Add event
</div>
<table class='week-calendar'>
  <thead>
    <tr>
      <% (@monday..@sunday).each do |day| %>
        <th class='week-calendar__date-title'>
          <div class='week-calendar__week-day'><%= day.strftime("%A") %></div>
          <div class='week-calendar__week-date'><%= day.strftime("#{ day.strftime("%d").to_i.ordinalize } %b") %></div>
        </th>
      <% end %>
    </tr>
  </thead>
  <tbody>
    <tr>
      <% (@monday..@sunday).each do |day| %>
        <td class='week-calendar__cell'>
          <% @schedule[day.cwday - 1].each do |event| %>
            <% if event[:position] < 3 %>
              <div style="width: <%= (100.0/7 * event[:duration]).round(2) - (event[:from_last_week] ? 0 : 1) - (event[:to_next_week] ? 0 : 1) %>%; top: <%= 70 * event[:position] - 15 %>px;" class="week-calendar__event <%= event[:to_next_week] ? 'week-calendar__next-week' : '' %> <%= event[:from_last_week] ? 'week-calendar__last-week' : '' %>">
                <div>
                  <%= event[:title].truncate(12, omission: '...') if event[:title].present? %>
                </div>
                <div>
                  <b><%= event[:description].truncate(12, omission: '...') if event[:description].present? %></b>
                </div>
                <div>
                  <%= event[:signature].truncate(12, omission: '...') if event[:signature].present? %>
                </div>
              </div>
            <% elsif event[:position] >= 3 %>
              <div class="week-calendar__more">
                more
              </div>
            <% end %>
          <% end %>
        </td>
      <% end %>
    </tr>
  </tbody>
</table>